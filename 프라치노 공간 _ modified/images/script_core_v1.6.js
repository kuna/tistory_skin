/* Keep All Plug-in - mytory@gmail.com, MIT or GPL2
   jQuery Browser Plug-in - Copyright 2008 Jonathan Neal under dual, MIT or GPL
   Linkify - http://github.com/maranomynet/linkify, MIT or GPL */
var compStyle=document.createElement("link");compStyle.rel="stylesheet";compStyle.type="text/css";compStyle.href=rootURI+"style_compatibility_v1.5.css";head.appendChild(compStyle);(function(a){a.browserTest=function(b,c){var k=function(a,d){for(var c=0;c<d.length;c+=1)a=a.replace(d[c][0],d[c][1]);return a},g=function(c,d,b,f){d={name:k((d.exec(c)||["unknown","unknown"])[1],b)};d[d.name]=!0;d.version=(f.exec(c)||["X","X","X","X"])[3];d.name.match(/safari/)&&400<d.version&&(d.version="2.0");"presto"===d.name&&(d.version=9.27<a.browser.version?"futhark":"linear_b");d.versionNumber=parseFloat(d.version,10)||0;d.versionX="X"!==d.version?(d.version+"").substr(0,1):"X";d.className=d.name+d.versionX;return d};b=(b.match(/Opera|Navigator|Minefield|KHTML|Chrome/)?k(b,[[/(Firefox|MSIE|KHTML,\slike\sGecko|Konqueror)/,""],["Chrome Safari","Chrome"],["KHTML","Konqueror"],["Minefield","Firefox"],["Navigator","Netscape"]]):b).toLowerCase();a.browser=a.extend(c?{}:a.browser,g(b,/(camino|chrome|firefox|netscape|konqueror|lynx|msie|opera|safari)/,[],/(camino|chrome|firefox|netscape|netscape6|opera|version|konqueror|lynx|msie|safari)(\/|\s)([a-z0-9\.\+]*?)(\;|dev|rel|\s|$)/));a.layout=g(b,/(gecko|konqueror|msie|opera|webkit)/,[["konqueror","khtml"],["msie","trident"],["opera","presto"]],/(applewebkit|rv|konqueror|msie)(\:|\/|\s)([a-z0-9\.]*?)(\;|\)|\s)/);a.os={name:(/(win|mac|linux|sunos|solaris|iphone)/.exec(navigator.platform.toLowerCase())||["unknown"])[0].replace("sunos","solaris")};c||a("html").addClass([a.os.name,a.browser.name,a.browser.className,a.layout.name,a.layout.className].join(" "))};a.browserTest(navigator.userAgent)})(jQuery);jQuery.fn.wordBreakKeepAll=function(a){a=$.extend({OffForIE:!1,useCSSonIE:!0},a);if(/MSIE/.test(navigator.userAgent)&&!1==a.OffForIE&&!0==a.useCSSonIE)var b=function(a){$(a).css({"word-break":"keep-all","word-wrap":"break-word"});"inline"==$(a).css("display")&&$(a).css("display","block")};else if(!/MSIE/.test(navigator.userAgent)||/MSIE/.test(navigator.userAgent)&&!1==a.OffForIE&&!1==a.useCSSonIE)b=function(a){var b=$(a).html(),b=b.replace(/(\r\n|\n|\r)/gm," ＃＆＊＠§ "),b=b.split(" "),b=b.filter(function(a){return a});$(a).text("");for(var g=!1,h="",d=0,t=b.length;d<t;d++){var f=b[d],h=!1==g&&f.lastIndexOf(">")==f.lastIndexOf("<")&&-1==f.indexOf("＃＆＊＠§")?h+('<span style="white-space: nowrap">'+f+"</span> "):h+(f+" ");f.lastIndexOf(">")<f.lastIndexOf("<")&&(g=!0);f.lastIndexOf("<")<f.lastIndexOf(">")&&(g=!1)}$(a).html(h.replace(/＃＆＊＠§/g,"\n"))};return this.each(function(){b(this)})};(function(a){var b=/(^|["'(\s]|&lt;)(www\..+?\..+?)((?:[:?]|\.+)?(?:\s|$)|&gt;|[)"',])/g,c=/(^|["'(\s]|&lt;)((?:(?:https?|ftp):\/\/|mailto:).+?)((?:[:?]|\.+)?(?:\s|$)|&gt;|[)"',])/g,k=function(a){return a.replace(b,'$1<a target="_blank" href="<``>://$2">$2</a>$3').replace(c,'$1<a target="_blank" href="$2">$2</a>$3').replace(/"<``>/g,'"http')},g=a.fn.linkify=function(b,d){a.isPlainObject(b)||(b={use:"string"==typeof b?b:void 0,handleLinks:a.isFunction(b)?b:d});var c=b.use,f=g.plugins||{},q=[k],m,r=[],s=b.handleLinks;if(void 0==c||"*"==c)for(var l in f)q.push(f[l]);else for(var c=a.isArray(c)?c:a.trim(c).split(/ *, */),n=0,u=c.length;n<u;n++)l=c[n],(l=f[l])&&q.push(l);this.each(function(){for(var d=this.childNodes,b=d.length;b--;){var c=d[b];if(3==c.nodeType){var e=c.nodeValue;if(1<e.length&&/\S/.test(e)){var f,g;m=m||a("<div/>")[0];m.innerHTML="";m.appendChild(c.cloneNode(!1));for(var h=m.childNodes,k=0,l;l=q[k];k++)for(var n=h.length,p;n--;)p=h[n],3==p.nodeType&&(e=p.nodeValue,1<e.length&&/\S/.test(e)&&(g=e,e=e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),e=a.isFunction(l)?l(e):e.replace(l.re,l.tmpl),f=f||g!=e,g!=e&&a(p).after(e).remove()));e=m.innerHTML;s&&(e=a("<div/>").html(e),r=r.concat(e.find("a").toArray().reverse()),e=e.contents());f&&a(c).after(e).remove()}}else 1!=c.nodeType||/^(a|button|textarea)$/i.test(c.tagName)||arguments.callee.call(c)}});s&&s(a(r.reverse()));return this};g.plugins={mailto:{re:/(^|["'(\s]|&lt;)([^"'(\s&]+?@.+\.[a-z]{2,7})(([:?]|\.+)?(\s|$)|&gt;|[)"',])/gi,tmpl:'$1<a target="_blank" href="mailto:$2">$2</a>$3'}}})(jQuery);var html=$("html"),$head=$("head"),header=$("#header"),nav=$("#nav"),navNum=nav.find("li").length,wrap=$("#wrap"),content=$(".content"),contentF=$("#list-entry, #tag-entry, #protect-entry, #article-entry");$(function(){$("#jacket").find("h1").wordBreakKeepAll({useCSSonIE:!0});$("#headline").wordBreakKeepAll({useCSSonIE:!0});$("#ts-nav");var a=$(".tt_menubar_logout").find("a"),b=a.text(),a=a.attr("href"),c=$("#login");c.attr("href",a).text(b);""==c.text()&&c.remove();contentF.css("min-height",36*navNum+124+"px");b=90*navNum+"px";nav.find("ul").css("width",b);$("#cmt-entry p").linkify();$("#loading").remove();b=$("#close");a=$("#nav-toggle");c=$("#nav-close");a.click(function(a){a.preventDefault();html.removeClass("scroll inertia about-open").toggleClass("nav-open");k.hide()});c.click(function(a){a.preventDefault();html.removeClass("scroll nav-open")});var a=$("#about-toggle"),k=$("#about"),c=$("#about-close");a.click(function(a){a.preventDefault();html.toggleClass("about-open");k.fadeToggle(200)});c.click(function(a){a.preventDefault();html.removeClass("about-open");k.fadeOut(200)});$("#info p").wordBreakKeepAll({useCSSonIE:!0});var g=$("#search"),a=$("#search-toggle"),h=$("#search-field"),c=$("#search-close");a.click(function(a){a.preventDefault();html.addClass("search-open");g.fadeIn(200);h.focus()});h.focusout(function(){html.removeClass("search-open");g.fadeOut(200)});c.click(function(a){a.preventDefault();html.removeClass("search-open");g.fadeOut(200);h.blur()});b.bind("mousewheel click touchstart touchend",function(a){a.preventDefault();html.addClass("scroll").removeClass("search-open nav-open about-open");k.fadeOut(200);g.fadeOut(200);h.blur();return!1});b=$("#link, #nav, #share");b.addClass("inertia");b.bind("mousewheel touchstart",function(a){$(this).removeClass("inertia")});$("#go-to-top, #go-to-top-btn").click(function(){$("html, body").animate({scrollTop:0},400);return!1});$("a, button, label, textarea").bind("touchstart touchend",function(){$(this).toggleClass("hover")})});